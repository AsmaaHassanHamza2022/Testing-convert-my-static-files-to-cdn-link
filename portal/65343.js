(self.webpackChunkportal=self.webpackChunkportal||[]).push([[65343],{65343:(I,h,o)=>{o.r(h),o.d(h,{OfferModule:()=>L});var c=o(28675),O=o(81011),p=o(92482),M=o(91236),s=o(78570),x=o(4125),e=o(11705),_=o(62411),f=o(37385),u=o(82830);function v(n,d){if(1&n&&(e.\u0275\u0275elementStart(0,"span",18),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext(2).$implicit,i=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngClass",i.offerId===(null==t.offer?null:t.offer.id)?"active":"inactive"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.count)}}function E(n,d){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",14)(1,"button",15),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext().$implicit,a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.filterOffer(null==r.offer?null:r.offer.id))}),e.\u0275\u0275elementStart(2,"span",16),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,v,2,2,"span",17),e.\u0275\u0275elementEnd()()}if(2&n){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(null==t.offer?null:t.offer.displayName),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.count>=0)}}function C(n,d){if(1&n&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,E,5,2,"div",13),e.\u0275\u0275elementContainerEnd()),2&n){const t=d.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.count>0)}}function y(n,d){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",24),e.\u0275\u0275listener("click",function(){const a=e.\u0275\u0275restoreView(t).$implicit,l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.filterOffer(a.offer.id))}),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()}if(2&n){const t=d.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2(" ",null==t.offer?null:t.offer.displayName," (",t.count,") ")}}function m(n,d){if(1&n&&(e.\u0275\u0275elementStart(0,"div",19)(1,"div",20)(2,"button",21),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",22),e.\u0275\u0275template(6,y,2,2,"button",23),e.\u0275\u0275elementEnd()()()),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,2,"CMSService::offer:AllOffer")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",t.totalOffers)}}function w(n,d){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",25)(1,"div",26),e.\u0275\u0275listener("click",function(){const a=e.\u0275\u0275restoreView(t).$implicit,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.showDetails(null==a?null:a.id))}),e.\u0275\u0275elementStart(2,"div",27),e.\u0275\u0275element(3,"app-base64-file-preview",28),e.\u0275\u0275pipe(4,"attachmentFile"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",29)(6,"span",30),e.\u0275\u0275text(7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div",31)(9,"span",32),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(12,"\xa0 "),e.\u0275\u0275elementStart(13,"div")(14,"span",33),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"span",34),e.\u0275\u0275text(18),e.\u0275\u0275pipe(19,"date"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(20," \xa0 "),e.\u0275\u0275elementStart(21,"span",35),e.\u0275\u0275text(22),e.\u0275\u0275pipe(23,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"span",36),e.\u0275\u0275text(25),e.\u0275\u0275pipe(26,"date"),e.\u0275\u0275elementEnd()()()()()()}if(2&n){const t=d.$implicit,i=e.\u0275\u0275nextContext();let r;e.\u0275\u0275advance(3),e.\u0275\u0275property("previewMode",i.PreviewModeEnum.Image)("base64File",e.\u0275\u0275pipeBind3(4,8,null==(r=t)?null:r.imageAttachmentId,t.entityName,t.serviceUrl)),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(null==t?null:t.title),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(11,12,"CMSService::Offers:OfferDate")),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(16,14,"CMSService::Offers:From")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(19,16,null==t?null:t.startDate,i.AppConsts.CalenderDateOnlyFormat)),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1("- \xa0",e.\u0275\u0275pipeBind1(23,19,"CMSService::Offers:to"),""),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(26,21,null==t?null:t.endDate,i.AppConsts.CalenderDateOnlyFormat))}}function P(n){return new s.ListFilterService(t=>n.getListPublic(t).pipe((0,x.switchMap)(i=>{const r={totalCount:i.totalCount,items:i.items.map(a=>({id:a.id,imageAttachmentId:a.mainImageId,publishDate:a.publishDate,title:a.title,endDate:a.endDate,startDate:a.startDate,entityName:"MainImage",serviceUrl:"cms-service/offers"}))};return(0,x.of)(r)})))}let g=(()=>{class n extends s.AbstractStandAloneListComponent{constructor(t,i,r){super(!0),this.service=t,this._offerService=i,this._activatedRoute=r,this.PreviewModeEnum=s.PreviewModeEnum,this.pageEnum=p.PageEnum,this.totalOffers=[],this.topOffers=[],this.maxResultCountOptions=[9,45,90],this.AppConsts=p.AppConsts,this._offerType=[]}ngOnInit(){this.list.maxResultCount=this.maxResultCountOptions[0],super.ngOnInit(),this.offerId=this.getUiStatusValue("offerTypeId")??null,this.filterOffer(this.offerId),this._getOfferType(),this._getOffersCount()}_getOfferType(){this.sub$=this._offerService.getOfferTypeLookup({maxResultCount:1e3}).subscribe(t=>{this._offerType=t.items.map(i=>({offer:i,count:null}))})}_getOffersCount(){this._offerType.forEach(t=>{t.count=null}),this.sub$=this._offerService.getListStatisticsPublic({filterText:this.quickFilter.filterValue,maxResultCount:1e3}).subscribe(t=>{t.forEach(a=>{const l=this._offerType.find(A=>A.offer.id===a.offerTypeId);l&&(l.count=a.count)});const i=this._offerType.map(a=>a.count).reduce((a,l)=>a+l,0),r={offer:{id:null,displayName:this.localizationService.instant("CMSService::Offers:All")},count:i};this.totalOffers=[r,...this._offerType].filter(a=>a.count>0),this.topOffers=this.totalOffers.filter(a=>a.count>0).slice(0,5)})}filterOffer(t){this.offerId=t,this.service.updateFilters({offerTypeId:t}),this.service.getData()}showDetails(t){this.route.navigate([`details/${t}`],{relativeTo:this._activatedRoute})}saveExtraInfoStatus(){super.saveExtraInfoStatus(),this.saveUiStatusValue("offerTypeId",this.offerId)}refreshFilters(t=!0){super.refreshFilters(t),this._getOffersCount()}ngOnDestroy(){this.sub$?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)(e.\u0275\u0275directiveInject(s.ListFilterService),e.\u0275\u0275directiveInject(M.K),e.\u0275\u0275directiveInject(c.ActivatedRoute))};static#t=this.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["app-offer"]],features:[e.\u0275\u0275ProvidersFeature([O.ListService,s.SelectedFiltersBannerService,{provide:s.ListFilterService,useFactory:P,deps:[M.K]}]),e.\u0275\u0275InheritDefinitionFeature],decls:18,vars:32,consts:[[1,"mb-2",3,"pageTitle","icon"],[3,"filterText","searchInputText","isAdvancedSearch","filterTextChange"],[1,"d-flex","flex-nowrap","justify-content-between","align-items-center","gap","category"],[3,"track"],[1,"d-flex","flex-nowrap","gap"],[4,"ngFor","ngForOf"],["class","other gap",4,"ngIf"],[1,"w-100"],["loaderImage","card-loading.svg","nodataImage","offers.svg",1,"w-100",3,"isLoadingData","isDataFiltered","isDataNotEmpty","nodataMessage","nodataHint","noFilterResultImage","noFilterResultMessage"],[1,"row"],["class","col-lg-4 col-md-6 col-sm-12 mb-3",4,"ngFor","ngForOf"],[1,"card"],[1,"py-2",3,"page","size","count","maxResultCountOptions","pageNumberChanged","pageSizeChanged"],["class","offer-type",4,"ngIf"],[1,"offer-type"],[3,"click"],[1,"title","me-2"],[3,"ngClass",4,"ngIf"],[3,"ngClass"],[1,"other","gap"],["ngbDropdown","","placement","bottom-end","autoClose","outside",1,"d-inline-block","all-types"],["type","button","id","dropdownBasic1","ngbDropdownToggle",""],["ngbDropdownMenu","","aria-labelledby","dropdownBasic1"],["ngbDropdownItem","",3,"click",4,"ngFor","ngForOf"],["ngbDropdownItem","",3,"click"],[1,"col-lg-4","col-md-6","col-sm-12","mb-3"],["Class","offer-container",3,"click"],[1,"image"],[3,"previewMode","base64File"],[1,"offer-details"],[1,"title"],[1,"date"],[1,"label"],[1,"range"],[1,"value","ms-1"],[1,"me-1","range"],[1,"value"]],template:function(i,r){1&i&&(e.\u0275\u0275elementStart(0,"app-page-header",0)(1,"app-sw-filter",1),e.\u0275\u0275listener("filterTextChange",function(l){return r.chnageFilterText(l)}),e.\u0275\u0275pipe(2,"abpLocalization"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(3,"div",2)(4,"ng-scrollbar",3)(5,"div",4),e.\u0275\u0275template(6,C,2,1,"ng-container",5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(7,m,7,4,"div",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div",7)(9,"app-nodata-or-loading",8),e.\u0275\u0275pipe(10,"abpLocalization"),e.\u0275\u0275pipe(11,"abpLocalization"),e.\u0275\u0275pipe(12,"abpLocalization"),e.\u0275\u0275pipe(13,"abpLocalization"),e.\u0275\u0275elementStart(14,"div",9),e.\u0275\u0275template(15,w,27,24,"div",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"div",11)(17,"app-pager",12),e.\u0275\u0275listener("pageNumberChanged",function(l){return r.onPageNumberChange(l)})("pageSizeChanged",function(l){return r.onPageSizeChange(l)}),e.\u0275\u0275elementEnd()()()()),2&i&&(e.\u0275\u0275property("pageTitle","CMSService::Offer:Title")("icon","offers"),e.\u0275\u0275advance(1),e.\u0275\u0275property("filterText",r.quickFilter.filterValue)("searchInputText",e.\u0275\u0275pipeBind1(2,22,"CMSService::Offers:Search"))("isAdvancedSearch",!1),e.\u0275\u0275advance(3),e.\u0275\u0275property("track","horizontal"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",r.topOffers),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.totalOffers.length>5),e.\u0275\u0275advance(1),e.\u0275\u0275classProp("nodata",!(null!=r.service.data.items&&r.service.data.items.length)),e.\u0275\u0275advance(1),e.\u0275\u0275property("isLoadingData",r.service.isLoading)("isDataFiltered",r.service.isFiltering)("isDataNotEmpty",r.service.data.items.length>0)("nodataMessage",e.\u0275\u0275pipeBind1(10,24,"CMSService::NoOffers"))("nodataHint",e.\u0275\u0275pipeBind1(11,26,"CMSService::ReturnLater"))("noFilterResultImage",e.\u0275\u0275pipeBind1(12,28,"offers.svg"))("noFilterResultMessage",e.\u0275\u0275pipeBind1(13,30,"CMSService::NoOffersAfterFiltering")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",r.service.data.items),e.\u0275\u0275advance(2),e.\u0275\u0275property("page",r.list.page+1)("size",r.list.maxResultCount)("count",r.service.data.totalCount)("maxResultCountOptions",r.maxResultCountOptions))},dependencies:[_.NgClass,_.NgForOf,_.NgIf,s.PageHeaderComponent,s.Base64FilePerviewComponent,p.PagerComponent,p.NodataOrLoadingComponent,p.SwFilterComponent,f.NgScrollbar,u.NgbDropdown,u.NgbDropdownToggle,u.NgbDropdownMenu,u.NgbDropdownItem,_.DatePipe,O.LocalizationPipe,s.AttachmentPipe],styles:["ng-scrollbar[_ngcontent-%COMP%]{height:75px;width:100%}ng-scrollbar[_ngcontent-%COMP%]   .offer-type[_ngcontent-%COMP%]{border-radius:40px;border:2px solid var(--neutral-100, #f1f5f9);background:var(--basic-white, #fff);padding:12px 14px;font-size:.875rem;font-weight:700}ng-scrollbar[_ngcontent-%COMP%]   .offer-type[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;border:none}ng-scrollbar[_ngcontent-%COMP%]   .offer-type[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--text-body, #1e293b);white-space:nowrap}ng-scrollbar[_ngcontent-%COMP%]   .offer-type[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{padding:0 8px;border-radius:8px;color:var(--basic-white, #fff)}.active[_ngcontent-%COMP%]{padding:0 8px;border-radius:8px;color:var(--basic-white, #fff);background:var(--secondary-dark-purple-75, #8653e0)}.inactive[_ngcontent-%COMP%]{padding:0 8px;border-radius:8px;color:var(--basic-white, #fff);background:var(--neutral-300, #cbd5e1)}.gap[_ngcontent-%COMP%]{gap:10px}.offer-container[_ngcontent-%COMP%]   .offer-details[_ngcontent-%COMP%]{position:relative;display:flex;padding:16px 24px;flex-direction:column;gap:8px;border-radius:12px;border:1px solid var(--neutral-200, #E2E8F0);background:var(--basic-white, #FFF);box-shadow:0 6px 16px #0000000a;margin-top:-35px;height:calc(100% - 231px)}.offer-container[_ngcontent-%COMP%]   .offer-details[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{overflow:hidden;color:var(--text-body, #1E293B);text-overflow:ellipsis;font-size:.875rem;font-weight:700}.offer-container[_ngcontent-%COMP%]   .offer-details[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;line-height:22px;font-size:.75rem;font-weight:700;transition:all .3s ease-out}.offer-container[_ngcontent-%COMP%]   .offer-details[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:var(--text-placeholder, #94A3B8);white-space:nowrap}.offer-container[_ngcontent-%COMP%]   .offer-details[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   .range[_ngcontent-%COMP%]{color:var(--text-body, #1E293B);font-weight:500}.offer-container[_ngcontent-%COMP%]   .offer-details[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--secondary-light-purple-100, #7F92FF)}.offer-container[_ngcontent-%COMP%]:hover{cursor:pointer}.offer-container[_ngcontent-%COMP%]:hover   .offer-details[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--secondary-dark-purple-100, #5E1AD5)}.offer-container[_ngcontent-%COMP%]:hover   .offer-details[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:var(--secondary-light-purple-100, #7F92FF)}@media (max-width: 1199px){.category[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-end!important}}[_nghost-%COMP%]     ng-scrollbar .scrollbar-control{visibility:hidden}[_nghost-%COMP%]     ng-scrollbar:hover .scrollbar-control{visibility:visible}[_nghost-%COMP%]     .all-types{height:75px;z-index:10}[_nghost-%COMP%]     .all-types button.dropdown-toggle{border-radius:80px;border:2px solid var(--neutral-100, #f1f5f9);background:var(--basic-white, #fff);padding:12px 16px;color:var(--text-body, #1e293b);font-size:14px;font-weight:700}[_nghost-%COMP%]     .all-types button.dropdown-toggle:after{margin-right:1rem}[_nghost-%COMP%]     .all-types .dropdown-menu.show{display:flex;flex-wrap:wrap;width:calc(100vw - 81px)!important}@media screen and (max-width: 575px){[_nghost-%COMP%]     .all-types .dropdown-menu.show{width:calc(100vw - 50px)!important}}[_nghost-%COMP%]     .all-types .dropdown-menu.show .dropdown-item{overflow:hidden;color:var(--text-body, #1e293b);font-size:.875rem;font-weight:700;flex-basis:25%}@media screen and (max-width: 991px){[_nghost-%COMP%]     .all-types .dropdown-menu.show .dropdown-item{flex-basis:50%}}@media screen and (max-width: 575px){[_nghost-%COMP%]     .all-types .dropdown-menu.show .dropdown-item{flex-basis:100%}}[_nghost-%COMP%]     .offer-container{height:100%}[_nghost-%COMP%]     .offer-container .image{height:266px;overflow:hidden;border-radius:12px}[_nghost-%COMP%]     .offer-container .image app-base64-file-preview img{box-shadow:0 6px 16px #0000000a;border-radius:12px;border:1px solid var(--neutral-200, #E2E8F0);transition:all .3s ease-out}[_nghost-%COMP%]     .offer-container:hover .image app-base64-file-preview img{transform:scale(1.1)}@media (max-width: 575px){[_nghost-%COMP%]     app-page-header .page-body{padding:10px!important}[_nghost-%COMP%]     div.card{height:124px}[_nghost-%COMP%]     div.card app-pager .app-pager{flex-direction:column}[_nghost-%COMP%]     div.card app-pager .app-pager .list-unstyled .pages a{padding:0 4px}[_nghost-%COMP%]     div.card app-pager .paging-list{margin-top:18px;border-top:1px solid #EEE;width:100%;display:flex;justify-content:center;padding:10px 0}}html[dir=rtl][_nghost-%COMP%]   .offer-container[_ngcontent-%COMP%]:hover   .offer-details[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%], html[dir=rtl]   [_nghost-%COMP%]   .offer-container[_ngcontent-%COMP%]:hover   .offer-details[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{border-right:2px solid #7F92FF;padding-right:5px}html[dir=ltr][_nghost-%COMP%]   .offer-container[_ngcontent-%COMP%]:hover   .offer-details[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%], html[dir=ltr]   [_nghost-%COMP%]   .offer-container[_ngcontent-%COMP%]:hover   .offer-details[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{border-left:2px solid #7F92FF;padding-left:5px}"]})}return n})();var D=o(33814),S=o(37372);const b=[{path:"",component:g},{path:"details/:id",component:D.j,data:{mediaType:S.Q.Offers,resource:"CMSService::Offer",icon:"offers"}}];let F=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.\u0275\u0275defineNgModule({type:n});static#n=this.\u0275inj=e.\u0275\u0275defineInjector({imports:[c.RouterModule.forChild(b),c.RouterModule]})}return n})();var T=o(92134);let L=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.\u0275\u0275defineNgModule({type:n});static#n=this.\u0275inj=e.\u0275\u0275defineInjector({imports:[F,T.b]})}return n})()},92134:(I,h,o)=>{o.d(h,{b:()=>P});var c=o(81011),p=o(92482),s=o(78570),e=o(37385),f=o(82830),v=o(31093),C=o(62411),m=o(11705);let P=(()=>{class g{static#e=this.\u0275fac=function(b){return new(b||g)};static#t=this.\u0275mod=m.\u0275\u0275defineNgModule({type:g});static#n=this.\u0275inj=m.\u0275\u0275defineInjector({imports:[c.CoreModule,p.SharedModule,s.AbpUtilsModule,e.NgScrollbarModule,c.CoreModule,s.AbpUtilsModule,p.SharedModule,f.NgbTooltipModule,v.NgSelectModule,C.CommonModule,e.NgScrollbarModule,f.NgbDropdownModule,f.NgbDatepickerModule]})}return g})()}}]);