(self.webpackChunkportal=self.webpackChunkportal||[]).push([[19657],{19657:(I,y,s)=>{s.r(y),s.d(y,{RequestModule:()=>ye});var e=s(11705),x=s(28675),l=s(78570),g=s(81011),m=s(4125),_=function(n){return n[n.MyRequests=1]="MyRequests",n[n.OnBehalfForMe=2]="OnBehalfForMe",n[n.OnBehalfByMe=3]="OnBehalfByMe",n}(_||{}),h=s(15876);let R=(()=>{class n extends l.ListFilterService{constructor(t,a,i){super(),this.list=t,this._requestService=a,this._selectedFiltersBannerService=i,this._filterChanged$=new m.BehaviorSubject(void 0),this.filterChanged$=this._filterChanged$.asObservable()}init(t,a,i){this._changeMainTab$=new m.BehaviorSubject(t),this._changeServiceCategoryTab$=new m.BehaviorSubject(a),this._changeSubCategoryTab$=new m.BehaviorSubject(i),this.changeMainTab$=this._changeMainTab$.asObservable(),this.changeServiceCategoryTab$=this._changeServiceCategoryTab$.asObservable(),this.changeSubCategoryTab$=this._changeSubCategoryTab$.asObservable()}getList(t){this.isLoading=!0;const a=this._changeMainTab$.value;let i;return a===_.MyRequests?i=this._requestService.getList({...t,...this._filters}):a===_.OnBehalfForMe?i=this._requestService.getListRequestOnBehalfForMe({...t,...this._filters}):a===_.OnBehalfByMe&&(i=this._requestService.getListRequestOnBehalfByMe({...t,...this._filters})),i?.pipe((0,m.finalize)(()=>this.isLoading=!1))}getRequestStatistics(){let t;const a=this._changeMainTab$.value;return a===_.MyRequests?t=this._requestService.getListStatisticsPublic({...this._filters,serviceCategoryId:null,serviceSubCategoryId:null}):a===_.OnBehalfForMe?t=this._requestService.getListStatisticsOnBehalfForMe({...this._filters,serviceCategoryId:null,serviceSubCategoryId:null}):a===_.OnBehalfByMe&&(t=this._requestService.getListStatisticsOnBehalfByMe({...this._filters,serviceCategoryId:null,serviceSubCategoryId:null})),t}getService(t,a){return this._requestService.getServiceSubCategoryLookup({...a,parentId:t})}withdrawRequest(t){return this._requestService.withdraw(t)}refresh(t=!0){this.getData(t)}getData(t=!0){super.getData(t),this._filterChanged$.next(!0)}changeTab(t){this._changeMainTab$.next(t)}changeServiceCategory(t){this._changeServiceCategoryTab$.next(t)}changeSubCategory(t){this._changeSubCategoryTab$.next(t)}getUsersLookUpLookup(t){return this._requestService.getUsersLookup(t)}static#e=this.\u0275fac=function(a){return new(a||n)(e.\u0275\u0275inject(g.ListService),e.\u0275\u0275inject(h.s),e.\u0275\u0275inject(l.SelectedFiltersBannerService))};static#t=this.\u0275prov=e.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac})}return n})();var d=s(62411),M=s(42595),F=s(37385),u=s(36394),p=s(92482),C=s(49095),v=s(74478),f=s(82830);function T(n,o){if(1&n&&(e.\u0275\u0275elementStart(0,"div")(1,"div",37),e.\u0275\u0275element(2,"input",38),e.\u0275\u0275elementStart(3,"label",39),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"abpLocalization"),e.\u0275\u0275elementEnd()()()),2&n){const t=o.$implicit;e.\u0275\u0275classProp("w-100",!t)("w-50",t),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",t)("id","requestStatus"+t),e.\u0275\u0275advance(1),e.\u0275\u0275property("for","requestStatus"+t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(5,8,t?"RequestService::RequestStatus:"+t:"TaskService::TaskFilter:All")," ")}}function b(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",9)(1,"div",10)(2,"label",40),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"app-ng-select-auto-complete",41),e.\u0275\u0275listener("valueChanged",function(i){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(r.selectRequestFormDropDown(i,"createdByUserName"))}),e.\u0275\u0275elementEnd()()()}if(2&n){const t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,2,"RequestService::RequestFilter:OnBehalfRequester")),e.\u0275\u0275advance(2),e.\u0275\u0275property("searchFn",t.searchUsersFn)}}function O(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",9)(1,"div",10)(2,"label",42),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"app-ng-select-auto-complete",43),e.\u0275\u0275listener("valueChanged",function(i){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(r.selectRequestFormDropDown(i,"createdForUserName"))}),e.\u0275\u0275elementEnd()()()}if(2&n){const t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,2,"RequestService::RequestFilter:OnBehalfOf")),e.\u0275\u0275advance(2),e.\u0275\u0275property("searchFn",t.searchUsersFn)}}function E(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",8)(1,"div",9)(2,"div",10)(3,"label",11),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(6,"input",12),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"div",9)(8,"div",10)(9,"label",13),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(12,"input",14),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(13,"div",15)(14,"label",16),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"div",17),e.\u0275\u0275template(18,T,6,10,"div",18),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(19,"div",9)(20,"div",10)(21,"label",19),e.\u0275\u0275text(22),e.\u0275\u0275pipe(23,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(24,"input",20),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(25,b,6,4,"div",21),e.\u0275\u0275template(26,O,6,4,"div",21),e.\u0275\u0275elementStart(27,"div",9)(28,"div",10)(29,"label",22),e.\u0275\u0275text(30),e.\u0275\u0275pipe(31,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(32,"div",23),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275reference(34);return e.\u0275\u0275resetView(i.toggle())}),e.\u0275\u0275element(33,"input",24,25),e.\u0275\u0275elementStart(35,"div",26),e.\u0275\u0275element(36,"i",27),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(37,"div",9)(38,"div",10)(39,"label",28),e.\u0275\u0275text(40),e.\u0275\u0275pipe(41,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(42,"div",23),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275reference(44);return e.\u0275\u0275resetView(i.toggle())}),e.\u0275\u0275element(43,"input",29,30),e.\u0275\u0275elementStart(45,"div",26),e.\u0275\u0275element(46,"i",27),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(47,"div",9)(48,"div",10)(49,"label",31),e.\u0275\u0275text(50),e.\u0275\u0275pipe(51,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(52,"div",23),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275reference(54);return e.\u0275\u0275resetView(i.toggle())}),e.\u0275\u0275element(53,"input",32,33),e.\u0275\u0275elementStart(55,"div",26),e.\u0275\u0275element(56,"i",27),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(57,"div",9)(58,"div",10)(59,"label",34),e.\u0275\u0275text(60),e.\u0275\u0275pipe(61,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(62,"div",23),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275reference(64);return e.\u0275\u0275resetView(i.toggle())}),e.\u0275\u0275element(63,"input",35,36),e.\u0275\u0275elementStart(65,"div",26),e.\u0275\u0275element(66,"i",27),e.\u0275\u0275elementEnd()()()()()}if(2&n){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,14,"RequestService::RequestFilter:RequestNo")),e.\u0275\u0275advance(2),e.\u0275\u0275property("maxlength",t.ValidationConsts.FD058MaxLength),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(11,16,"RequestService::RequestFilter:RequestTitle")),e.\u0275\u0275advance(2),e.\u0275\u0275property("maxlength",t.ValidationConsts.FD058MaxLength),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(16,18,"RequestService::RequestFilter:CurrentStatus")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",t.RequestStatusOption),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(23,20,"RequestService::RequestFilter:RequestStatusDetails")),e.\u0275\u0275advance(2),e.\u0275\u0275property("maxlength",t.ValidationConsts.FD058MaxLength),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.tab===t.RequestTabEnum.OnBehalfForMe),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.tab===t.RequestTabEnum.OnBehalfByMe),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(31,22,"RequestService::RequestFilter:RequestDateFrom")),e.\u0275\u0275advance(10),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(41,24,"RequestService::RequestFilter:RequestDateTo")),e.\u0275\u0275advance(10),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(51,26,"RequestService::RequestFilter:CompletionDateFrom")),e.\u0275\u0275advance(10),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(61,28,"RequestService::RequestFilter:CompletionDateTo"))}}function w(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"form",2),e.\u0275\u0275listener("ngSubmit",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.submitFilterForm())}),e.\u0275\u0275elementStart(1,"div",3),e.\u0275\u0275template(2,E,67,30,"ng-template",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",5)(4,"button",6)(5,"span"),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"abpLocalization"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(8,"button",7),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.clearFilterForm())}),e.\u0275\u0275text(9),e.\u0275\u0275pipe(10,"abpLocalization"),e.\u0275\u0275elementEnd()()()}if(2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("formGroup",t.filtersForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!0),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(7,4,"::AdvancedFilter:Refresh")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(10,6,"::AdvancedFilter:Clear")," ")}}let L=(()=>{class n extends l.AbstractAdvancedFilterComponent{get _requestService(){return this.service}get tabForm(){return this.requestForm}get requestForm(){return this.filtersForm.controls.requestForm}constructor(){super(),this.serviceCategories=[],this.ValidationConsts=p.ValidationConsts,this.RequestStatus=C.Z,this.RequestStatusOption=[null,...Object.values(C.Z).filter(t=>!1===isNaN(Number(t)))],this.RequestTabEnum=_,this.searchUsersFn=this._searchUser.bind(this),this.searchServiceFn=this._searchServices.bind(this),this.service=(0,e.inject)(R)}ngOnInit(){super.ngOnInit(),this.selectedFiltersBannerService.init(this.requestForm,this.quickFilter),this._changeMainTabSub(),this._changeServiceCategoryTabSub(),this._changeSubCategorySub()}initForm(){this.filtersForm=this.fb.group({tab:new l.FilterFormControl({filterTitle:""}),requestForm:this._buildRequestFormControl()}),this.loadUiStatusFilterForm(),this.loadUiStatusFormFilterValue("requestFormValue",this.requestForm),this.requestForm.controls.serviceCategoryId.valueChanges.pipe((0,m.startWith)(void 0),(0,m.pairwise)()).subscribe(([t,a])=>{t!==a&&this.requestForm.controls.serviceSubCategoryId.patchValue(void 0)})}resetForm(){this.tabForm.reset()}removeFilterFormControl(t){this.tabForm.get(t).setValue(null)}refreshFilters(t=!0,a=!1){this.filtersFormValue=this.filtersForm.getRawValue(),a&&(this.tabForm.controls.serviceCategoryId.setValue(void 0),this.tabForm.controls.serviceSubCategoryId.setValue(void 0));const i=this.tabForm.getRawValue();this.service.updateFilters({...i}),this.service.getData(t),this._requestService.changeServiceCategory(this.tabForm.controls.serviceCategoryId.value),this._requestService.changeSubCategory(this.tabForm.controls.serviceSubCategoryId.value)}saveExtraInfoStatus(){this.saveUiStatusFormFilterValue("requestFormValue",this.requestForm),super.saveExtraInfoStatus()}selectRequestFormDropDown(t,a){this.changeFilterValueForDropDown(t,a,this.requestForm)}clearFilterForm(){this.tabForm.reset()}_searchServices(t){const a=this.tabForm.controls.serviceCategoryId.value;return a?this._requestService.getService(a,t):(0,m.of)([])}_changeMainTabSub(){const t=this._requestService.changeMainTab$.subscribe(a=>{this.filtersForm.controls.tab.patchValue(a),this.tab=a,this.selectedFiltersBannerService.init(this.tabForm,this.quickFilter);const r=this.tabForm.controls.createdForUserName;this.tabForm.controls.createdByUserName.filterTitle=this.tab===_.OnBehalfForMe?"RequestService::RequestFilter:OnBehalfRequester":void 0,r.filterTitle=this.tab===_.OnBehalfByMe?"RequestService::RequestFilter:OnBehalfOf":void 0,this.refreshFilters()});this.addSubsciption(t)}_changeServiceCategoryTabSub(){const t=this._requestService.changeServiceCategoryTab$.subscribe(a=>{const i=this.tabForm.controls.serviceCategoryId;i.value!==a&&(i.patchValue(a),this.refreshFilters())});this.addSubsciption(t)}_changeSubCategorySub(){const t=this._requestService.changeSubCategoryTab$.subscribe(a=>{const i=this.tabForm.controls.serviceSubCategoryId;i.value!==a&&(i.patchValue(a),this.refreshFilters())});this.addSubsciption(t)}_buildRequestFormControl(){return this.fb.group({requestNO:new l.FilterFormControl({filterTitle:"RequestService::RequestFilter:RequestNo"}),serviceName:new l.FilterFormControl({filterTitle:"RequestService::RequestFilter:RequestTitle",validatorOrOpts:[u.Validators.maxLength(p.ValidationConsts.FD058MaxLength),p.CustomValidators.InvalidCharacterValidator()]}),serviceCategoryId:new l.FilterFormControl({}),serviceSubCategoryId:new l.FilterFormControl({}),requestStatusCode:new l.FilterFormControl({filterTitle:"RequestService::RequestFilter:CurrentStatus",filterValueFun:t=>this.localizationService.instant("RequestService::RequestStatus:"+t)}),requestStatusDetails:new l.FilterFormControl({filterTitle:"RequestService::RequestFilter:RequestStatusDetails",validatorOrOpts:[u.Validators.maxLength(p.ValidationConsts.FD058MaxLength),p.CustomValidators.InvalidCharacterValidator()]}),startDateMin:new l.FilterFormControl({filterTitle:"RequestService::RequestFilter:RequestDateFrom"}),startDateMax:new l.FilterFormControl({filterTitle:"RequestService::RequestFilter:RequestDateTo"}),endDateMin:new l.FilterFormControl({filterTitle:"RequestService::RequestFilter:CompletionDateFrom"}),endDateMax:new l.FilterFormControl({filterTitle:"RequestService::RequestFilter:CompletionDateTo"}),createdByUserName:new l.FilterFormControl({filterTitle:"TaskService::RequestFilter:RequesterName",filterValueFun:null}),createdForUserName:new l.FilterFormControl({filterTitle:"TaskService::RequestFilter:OnBehalfRequester",filterValueFun:null})})}_searchUser(t){return this._requestService.getUsersLookUpLookup(t)}static#e=this.\u0275fac=function(a){return new(a||n)};static#t=this.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["app-request-filter"]],inputs:{serviceCategories:"serviceCategories"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:4,vars:10,consts:[[3,"filterText","isShowFilters","searchInputText","advancedSearchText","isQuickSearch","filterTextChange","showAdvancedFilter"],["class","filters-form","val1idateOnSubmit","",3,"formGroup","ngSubmit",4,"ngIf"],["val1idateOnSubmit","",1,"filters-form",3,"formGroup","ngSubmit"],[1,"scroll-bar"],[3,"ngIf"],[1,"filter-actions"],["type","submit",1,"btn","btn-primary"],["type","button",1,"btn","btn-close-bar",3,"click"],["formGroupName","requestForm",1,"row","gap-2"],[1,"col-12"],[1,"form-group"],["for","requestNO",1,"form-label"],["formControlName","requestNO",1,"form-control",3,"maxlength"],["for","serviceName",1,"form-label"],["formControlName","serviceName",1,"form-control",3,"maxlength"],[1,"col-12","form-group"],["for","requestStatusCode",1,"form-label"],[1,"d-flex","flex-wrap"],[3,"w-100","w-50",4,"ngFor","ngForOf"],["for","requestStatusDetails",1,"form-label"],["formControlName","requestStatusDetails",1,"form-control",3,"maxlength"],["class","col-12",4,"ngIf"],["for","startDateMin",1,"form-label"],[1,"date-picker-container",3,"click"],["name","datepicker","formControlName","startDateMin","ngbDatepicker","","datepickerClass","filter-calendar",1,"form-control"],["startDateMin","ngbDatepicker"],[1,"date-picker-icon"],[1,"icon-calendar"],["for","startDateMax",1,"form-label"],["name","datepicker","formControlName","startDateMax","ngbDatepicker","","datepickerClass","filter-calendar",1,"form-control"],["startDateMax","ngbDatepicker"],["for","endDateMin",1,"form-label"],["name","datepicker","formControlName","endDateMin","ngbDatepicker","","datepickerClass","filter-calendar",1,"form-control"],["endDateMin","ngbDatepicker"],["for","endDateMax",1,"form-label"],["name","datepicker","formControlName","endDateMax","ngbDatepicker","","datepickerClass","filter-calendar",1,"form-control"],["endDateMax","ngbDatepicker"],[1,"form-check","me-4"],["type","radio","name","requestStatusCode","formControlName","requestStatusCode",1,"form-check-input","input-check",3,"value","id"],[1,"form-label","text-nowrap",3,"for"],["for","createdByUserName",1,"form-label"],["formControlName","createdByUserName",3,"searchFn","valueChanged"],["for","createdForUserName",1,"form-label"],["formControlName","createdForUserName",3,"searchFn","valueChanged"]],template:function(a,i){1&a&&(e.\u0275\u0275elementStart(0,"app-sw-filter",0),e.\u0275\u0275listener("filterTextChange",function(c){return i.chnageFilterText(c)})("showAdvancedFilter",function(c){return c?i.showFilterSidebar():i.closeFilterSidebar()}),e.\u0275\u0275pipe(1,"abpLocalization"),e.\u0275\u0275pipe(2,"abpLocalization"),e.\u0275\u0275template(3,w,11,8,"form",1),e.\u0275\u0275elementEnd()),2&a&&(e.\u0275\u0275property("filterText",i.quickFilter.filterValue)("isShowFilters",i.isShowFilters)("searchInputText",e.\u0275\u0275pipeBind1(1,6,"RequestService::RequestFilter:SearchWithName"))("advancedSearchText",e.\u0275\u0275pipeBind1(2,8,"RequestService::RequestFilter:Filter"))("isQuickSearch",!1),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.filtersForm))},dependencies:[d.NgForOf,d.NgIf,u.\u0275NgNoValidate,u.DefaultValueAccessor,u.RadioControlValueAccessor,u.NgControlStatus,u.NgControlStatusGroup,u.MaxLengthValidator,u.FormGroupDirective,u.FormControlName,u.FormGroupName,g.FormSubmitDirective,v.ValidationGroupDirective,v.ValidationDirective,p.NgSelectAutoCompleteComponent,p.SwFilterComponent,f.NgbInputDatepicker,g.LocalizationPipe],styles:[".scroll-bar[_ngcontent-%COMP%]{height:calc(100vh - 140px);overflow-y:auto;overflow-x:hidden}"]})}return n})();var S=s(27437),q=s(21786),D=s(55e3);let B=(()=>{class n{constructor(t){this.restService=t,this.apiName="CmsKitPublic",this.create=(a,i,r,c)=>this.restService.request({method:"POST",url:`/api/cms-kit-public/comments/${a}/${i}`,body:r},{apiName:this.apiName,...c}),this.delete=(a,i)=>this.restService.request({method:"DELETE",url:`/api/cms-kit-public/comments/${a}`},{apiName:this.apiName,...i}),this.getList=(a,i,r)=>this.restService.request({method:"GET",url:`/api/cms-kit-public/comments/${a}/${i}`},{apiName:this.apiName,...r}),this.update=(a,i,r)=>this.restService.request({method:"PUT",url:`/api/cms-kit-public/comments/${a}`,body:i},{apiName:this.apiName,...r})}static#e=this.\u0275fac=function(a){return new(a||n)(e.\u0275\u0275inject(g.RestService))};static#t=this.\u0275prov=e.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function N(n,o){if(1&n&&e.\u0275\u0275element(0,"img",15),2&n){const t=o.fill;e.\u0275\u0275classProp("filled",100===t),e.\u0275\u0275propertyInterpolate1("src","./assets/images/rating/star",100===t?"-fill":"",".svg",e.\u0275\u0275sanitizeUrl)}}function V(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",16)(1,"button",17),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"button",18),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(i.skipEvaluation())}),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"abpLocalization"),e.\u0275\u0275elementEnd()()}if(2&n){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",t.isModalBusy),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,4,"RequestService::ServiceEvaluation:Evaluate")),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",t.isModalBusy),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(6,6,"RequestService::ServiceEvaluation:SkipEvaluate"))}}function P(n,o){1&n&&(e.\u0275\u0275elementStart(0,"div",16)(1,"button",19),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"abpLocalization"),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,1,"::Close")," "))}function k(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",2)(1,"form",3),e.\u0275\u0275listener("ngSubmit",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.evaluate())}),e.\u0275\u0275elementStart(2,"div",4)(3,"div",5),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div",6),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"ngb-rating",7),e.\u0275\u0275template(10,N,1,3,"ng-template"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(11,"hr",8),e.\u0275\u0275elementStart(12,"div",9)(13,"label",10),e.\u0275\u0275text(14),e.\u0275\u0275pipe(15,"abpLocalization"),e.\u0275\u0275elementStart(16,"span",11),e.\u0275\u0275text(17),e.\u0275\u0275pipe(18,"abpLocalization"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(19,"textarea",12),e.\u0275\u0275pipe(20,"abpLocalization"),e.\u0275\u0275text(21,"                    "),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(22,V,7,8,"div",13),e.\u0275\u0275template(23,P,4,3,"ng-template",null,14,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()()}if(2&n){const t=e.\u0275\u0275reference(24),a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroup",a.form),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,10,"RequestService::ServiceEvaluation:Title")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(8,12,"RequestService::ServiceEvaluation:OpinonMatter")),e.\u0275\u0275advance(2),e.\u0275\u0275property("max",5),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(15,14,"RequestService::ServiceEvaluation:Suggests")," \xa0 "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(18,16,"::Optional")),e.\u0275\u0275advance(2),e.\u0275\u0275property("placeholder",e.\u0275\u0275pipeBind1(20,18,"RequestService::ServiceEvaluation:SuggestsHint"))("maxlength",a.ValidationConsts.FD027MaxLength),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!a.isReadonly)("ngIfElse",t)}}let z=(()=>{class n{constructor(t,a,i,r,c,Fe){this._fb=t,this._toasterService=a,this._ratingServiceApi=i,this._commentServiceApi=r,this._confirmationService=c,this._localizationService=Fe,this.requestEvaluated=new e.EventEmitter,this.isModalBusy=!1,this.isModalOpen=!1,this.ValidationConsts=p.ValidationConsts,this.modalOptions={windowClass:"evaluation-modal",centered:!0}}openModal(t,a){this._buildForm(),this.requestId=t,this.isModalOpen=!0,this.entityType=`${p.AppConsts.RatingServiceForRequest}-${a}`,this._ratingServiceApi.getGroupedStarCounts(this.entityType,t).subscribe(i=>{this.isReadonly=i.starAvg>0,this.isReadonly&&(this.form.controls.starCount.patchValue(i.starAvg),this.form.controls.starCount.disable(),this.form.controls.text.disable())}),this._commentServiceApi.getList(this.entityType,t).subscribe(i=>{this.form.controls.text.patchValue(i.items.map(r=>r.text).join("\n"))})}_buildForm(){this.form=this._fb.group({starCount:[void 0,[u.Validators.required]],text:[void 0,[u.Validators.maxLength(p.ValidationConsts.FD027MaxLength),p.CustomValidators.InvalidCharacterValidator()]]})}evaluate(){this.form.invalid?this._toasterService.warn("::FormValidationWarining"):(this.isModalBusy=!0,this._ratingServiceApi.createWithComment(this.entityType,`${this.requestId}`,this.form.getRawValue()).pipe((0,m.finalize)(()=>this.isModalBusy=!1)).subscribe(()=>{this.isModalOpen=!1,this.requestEvaluated.emit(!0),this._confirmationService.success(void 0,this._localizationService.instant("RequestService::ServiceEvaluation:EvaluateSuccess"),void 0,{hideYesBtn:!0,cancelText:"::Close"}).subscribe()}))}skipEvaluation(){this._confirmationService.warn("::CONF004","::AreYouSure",void 0,{yesSeverity:"error"}).pipe((0,m.filter)(t=>t===l.SWConfirmation.SWStatus.confirm)).subscribe(()=>{this.isModalOpen=!1})}static#e=this.\u0275fac=function(a){return new(a||n)(e.\u0275\u0275directiveInject(u.FormBuilder),e.\u0275\u0275directiveInject(S.ToasterService),e.\u0275\u0275directiveInject(D.e),e.\u0275\u0275directiveInject(B),e.\u0275\u0275directiveInject(l.SWConfirmationService),e.\u0275\u0275directiveInject(g.LocalizationService))};static#t=this.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["app-request-evaluation"]],outputs:{requestEvaluated:"requestEvaluated"},decls:3,vars:3,consts:[[3,"busy","visible","options","visibleChange"],["abpBody",""],[1,"eval-card"],[3,"formGroup","ngSubmit"],[1,"form-group","align-items-center"],[1,"evaluation-label"],[1,"text-placeholder"],["formControlName","starCount",3,"max"],[1,"w-100","my-0"],[1,"form-group"],["for","text",1,"form-label"],[1,"optional-field"],["rows","5","id","text","formControlName","text",1,"form-control",3,"placeholder","maxlength"],["class","d-flex",4,"ngIf","ngIfElse"],["actionClose",""],["alt","rate",1,"star",3,"src"],[1,"d-flex"],[1,"btn","btn-primary","btn-action","me-2",3,"disabled"],["type","button",1,"btn","btn-outline-light","btn-action",3,"disabled","click"],["type","button","abpClose","",1,"btn","btn-outline-light"]],template:function(a,i){1&a&&(e.\u0275\u0275elementStart(0,"abp-modal",0),e.\u0275\u0275listener("visibleChange",function(c){return i.isModalOpen=c}),e.\u0275\u0275template(1,k,25,20,"ng-template",null,1,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&a&&e.\u0275\u0275property("busy",i.isModalBusy)("visible",i.isModalOpen)("options",i.modalOptions)},dependencies:[d.NgIf,u.\u0275NgNoValidate,u.DefaultValueAccessor,u.NgControlStatus,u.NgControlStatusGroup,u.MaxLengthValidator,u.FormGroupDirective,u.FormControlName,g.FormSubmitDirective,v.ValidationGroupDirective,v.ValidationDirective,S.ModalComponent,S.ModalCloseDirective,f.NgbRating,g.LocalizationPipe],styles:["[_nghost-%COMP%]{font-size:.875rem}.eval-card[_ngcontent-%COMP%]{gap:32px;display:flex;flex-direction:column;align-items:center}.eval-card[_ngcontent-%COMP%]   .card-label[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:bolder}.eval-card[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]{font-size:5.25rem;color:var(--success-600, #0D9488);line-height:0}.eval-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{gap:24px;display:flex;flex-direction:column;align-items:center;width:400px}.eval-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:8px}.eval-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .evaluation-label[_ngcontent-%COMP%]{font-size:1rem;font-weight:700}  .evaluation-modal abp-validation-error{width:100%}  .evaluation-modal ngb-rating{justify-content:space-between;width:400px;padding:0 16px}"]})}return n})();function U(n,o){if(1&n&&e.\u0275\u0275elementContainer(0,23),2&n){e.\u0275\u0275nextContext();const t=e.\u0275\u0275reference(19);e.\u0275\u0275property("ngTemplateOutlet",t)}}function A(n,o){if(1&n&&e.\u0275\u0275elementContainer(0,23),2&n){e.\u0275\u0275nextContext();const t=e.\u0275\u0275reference(19);e.\u0275\u0275property("ngTemplateOutlet",t)}}function $(n,o){if(1&n&&e.\u0275\u0275elementContainer(0,23),2&n){e.\u0275\u0275nextContext();const t=e.\u0275\u0275reference(21);e.\u0275\u0275property("ngTemplateOutlet",t)}}function j(n,o){if(1&n&&e.\u0275\u0275elementContainer(0,23),2&n){e.\u0275\u0275nextContext();const t=e.\u0275\u0275reference(21);e.\u0275\u0275property("ngTemplateOutlet",t)}}function W(n,o){if(1&n&&e.\u0275\u0275elementContainer(0,23),2&n){e.\u0275\u0275nextContext();const t=e.\u0275\u0275reference(15);e.\u0275\u0275property("ngTemplateOutlet",t)}}function G(n,o){if(1&n&&e.\u0275\u0275elementContainer(0,23),2&n){e.\u0275\u0275nextContext();const t=e.\u0275\u0275reference(17);e.\u0275\u0275property("ngTemplateOutlet",t)}}function K(n,o){if(1&n&&e.\u0275\u0275elementContainer(0,23),2&n){e.\u0275\u0275nextContext();const t=e.\u0275\u0275reference(25);e.\u0275\u0275property("ngTemplateOutlet",t)}}function H(n,o){if(1&n&&e.\u0275\u0275elementContainer(0,23),2&n){e.\u0275\u0275nextContext();const t=e.\u0275\u0275reference(27);e.\u0275\u0275property("ngTemplateOutlet",t)}}function Z(n,o){if(1&n&&e.\u0275\u0275elementContainer(0,23),2&n){e.\u0275\u0275nextContext();const t=e.\u0275\u0275reference(29);e.\u0275\u0275property("ngTemplateOutlet",t)}}function Q(n,o){if(1&n&&e.\u0275\u0275elementContainer(0,23),2&n){e.\u0275\u0275nextContext();const t=e.\u0275\u0275reference(23);e.\u0275\u0275property("ngTemplateOutlet",t)}}function Y(n,o){if(1&n&&e.\u0275\u0275element(0,"app-request-status-badge",24),2&n){const t=e.\u0275\u0275nextContext().value;e.\u0275\u0275property("requestStatus",t)}}function J(n,o){if(1&n&&e.\u0275\u0275element(0,"app-empty",25),2&n){const t=e.\u0275\u0275nextContext().value;e.\u0275\u0275property("value",t)}}function X(n,o){if(1&n&&(e.\u0275\u0275elementStart(0,"b"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().value;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t)}}function ee(n,o){if(1&n&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"date"),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().value,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind2(2,1,t,a.AppConsts.DateWithHourFormat)," ")}}function te(n,o){if(1&n&&e.\u0275\u0275text(0),2&n){const t=e.\u0275\u0275nextContext().value;e.\u0275\u0275textInterpolate1(" ",t," ")}}function ne(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",26),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext().row,r=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(r.redircetRequestUrl(i.formURL))}),e.\u0275\u0275element(1,"i",27),e.\u0275\u0275elementEnd()}if(2&n){const t=e.\u0275\u0275nextContext().row;e.\u0275\u0275property("disabled",!t.formURL)}}function ae(n,o){1&n&&e.\u0275\u0275element(0,"i",30)}function ie(n,o){1&n&&e.\u0275\u0275element(0,"img",31)}function re(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",26),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext().row,r=e.\u0275\u0275nextContext(2),c=e.\u0275\u0275reference(9);return e.\u0275\u0275resetView(r.showRatingModal(c,i))}),e.\u0275\u0275template(1,ae,1,0,"i",28),e.\u0275\u0275template(2,ie,1,0,"img",29),e.\u0275\u0275elementEnd()}if(2&n){const t=e.\u0275\u0275nextContext().row,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("disabled",t.requestStatusCode!==a.StatusCodeEnum.Cancelled&&t.requestStatusCode!==a.StatusCodeEnum.Closed),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.hasRate),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.hasRate)}}function oe(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",41),e.\u0275\u0275listener("click",function(){const r=e.\u0275\u0275restoreView(t).$implicit,c=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(c.redircetRequestUrl(r.actionUrl))}),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()}if(2&n){const t=o.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.actionName," ")}}function se(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",41),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext(2).row,r=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(r.withdrawRequest(i.requestNO))}),e.\u0275\u0275elementStart(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"abpLocalization"),e.\u0275\u0275elementEnd()()}2&n&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,1,"RequestService::WithdrawRequest")," "))}function le(n,o){1&n&&e.\u0275\u0275element(0,"i",42)}function ce(n,o){1&n&&e.\u0275\u0275element(0,"img",31)}function ue(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",32)(1,"button",33),e.\u0275\u0275element(2,"i",34),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",35),e.\u0275\u0275template(4,oe,2,1,"button",36),e.\u0275\u0275template(5,se,4,3,"button",37),e.\u0275\u0275elementStart(6,"button",38),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext().row,r=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(r.redircetRequestUrl(i.formURL))}),e.\u0275\u0275element(7,"i",39),e.\u0275\u0275elementStart(8,"span"),e.\u0275\u0275text(9),e.\u0275\u0275pipe(10,"abpLocalization"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(11,"button",38),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext().row,r=e.\u0275\u0275nextContext(2),c=e.\u0275\u0275reference(9);return e.\u0275\u0275resetView(r.showRatingModal(c,i))}),e.\u0275\u0275elementStart(12,"span"),e.\u0275\u0275template(13,le,1,0,"i",40),e.\u0275\u0275template(14,ce,1,0,"img",29),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"span"),e.\u0275\u0275text(16),e.\u0275\u0275pipe(17,"abpLocalization"),e.\u0275\u0275elementEnd()()()()}if(2&n){const t=e.\u0275\u0275nextContext().row,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275classProp("d-xl-none",0===t.actions.length&&!t.canWithdrawRequest),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngForOf",t.actions),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.canWithdrawRequest),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",!t.formURL),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(10,10,"RequestService::ActionView")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",t.requestStatusCode!==a.StatusCodeEnum.Cancelled&&t.requestStatusCode!==a.StatusCodeEnum.Closed),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!t.hasRate),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.hasRate),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(17,12,"RequestService::ActionEvaluation")," ")}}function pe(n,o){if(1&n&&(e.\u0275\u0275elementStart(0,"div",11),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",12),e.\u0275\u0275template(4,U,1,1,"ng-container",13),e.\u0275\u0275template(5,A,1,1,"ng-container",13),e.\u0275\u0275template(6,$,1,1,"ng-container",13),e.\u0275\u0275template(7,j,1,1,"ng-container",13),e.\u0275\u0275template(8,W,1,1,"ng-container",13),e.\u0275\u0275template(9,G,1,1,"ng-container",13),e.\u0275\u0275template(10,K,1,1,"ng-container",13),e.\u0275\u0275template(11,H,1,1,"ng-container",13),e.\u0275\u0275template(12,Z,1,1,"ng-container",13),e.\u0275\u0275template(13,Q,1,1,"ng-container",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(14,Y,1,1,"ng-template",null,15,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(16,J,1,1,"ng-template",null,16,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(18,X,2,1,"ng-template",null,17,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(20,ee,3,4,"ng-template",null,18,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(22,te,1,1,"ng-template",null,19,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(24,ne,2,1,"ng-template",null,20,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(26,re,3,3,"ng-template",null,21,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(28,ue,18,14,"ng-template",null,22,e.\u0275\u0275templateRefExtractor)),2&n){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,11,t.name)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngSwitch",t.prop),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","requestNO"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","serviceName"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","startDate"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","endDate"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","requestStatusCode"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","requestStatusDetails"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","actionView"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","actionRate"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","actions")}}function me(n,o){if(1&n&&(e.\u0275\u0275elementStart(0,"ngx-datatable-column",9),e.\u0275\u0275pipe(1,"abpLocalization"),e.\u0275\u0275template(2,pe,30,13,"ng-template",10),e.\u0275\u0275elementEnd()),2&n){const t=o.$implicit;e.\u0275\u0275property("name",e.\u0275\u0275pipeBind1(1,8,t.name))("prop",t.prop)("flexGrow",t.flexGrow)("sortable",!1)("resizeable",!1)("draggable",!1)("maxWidth",t.maxWidth)("cellClass",t.cellClass)}}function _e(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275element(0,"app-nodata-or-loading",43),e.\u0275\u0275pipe(1,"abpLocalization"),e.\u0275\u0275pipe(2,"abpLocalization"),e.\u0275\u0275pipe(3,"abpLocalization"),e.\u0275\u0275pipe(4,"abpLocalization"),e.\u0275\u0275elementStart(5,"div",44)(6,"app-pager",45),e.\u0275\u0275listener("pageNumberChanged",function(i){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.onPageNumberChange(i))})("pageSizeChanged",function(i){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext(),c=e.\u0275\u0275reference(4);return e.\u0275\u0275resetView(r.onPageSizeChange(i,c))}),e.\u0275\u0275elementEnd()()}if(2&n){const t=o.rowCount,a=o.pageSize,i=o.curPage,r=e.\u0275\u0275nextContext();e.\u0275\u0275property("isLoadingData",r.service.isLoading)("isDataNotEmpty",r.data.items.length>0)("isDataFiltered",r.service.isFiltering)("nodataMessage",e.\u0275\u0275pipeBind1(1,10,"CMSService::NoNewRequests"))("nodataHint",e.\u0275\u0275pipeBind1(2,12,"CMSService::NoRequestsHint"))("noFilterResultMessage",e.\u0275\u0275pipeBind1(3,14,"CMSService::RequestsNoFilterResults"))("noFilterResultHint",e.\u0275\u0275pipeBind1(4,16,"CMSService::ChangeFilters")),e.\u0275\u0275advance(6),e.\u0275\u0275property("page",i)("size",a)("count",t)}}let de=(()=>{class n{constructor(t,a,i,r,c){this.service=t,this._router=a,this._environmentService=i,this._swConfirmationService=r,this._toasterService=c,this.data={items:[],totalCount:0},this.AppConsts=p.AppConsts,this.StatusCodeEnum=C.Z,this._columns=[{name:"RequestService::RequestList:RequestNo",prop:"requestNO",flexGrow:2},{name:"RequestService::RequestList:TaskName",prop:"serviceName",flexGrow:3},{name:"RequestService::RequestList:ServiceName",prop:"serviceSubCategoryName",flexGrow:3},{name:"RequestService::RequestList:ServiceCategory",prop:"serviceCategoryName",flexGrow:3},{name:"RequestService::RequestList:CurrentStatus",prop:"requestStatusCode",flexGrow:3},{name:"RequestService::RequestList:DetailsStatus",prop:"requestStatusDetails",flexGrow:3},{name:"RequestService::RequestList:RequestDate",prop:"startDate",flexGrow:3},{name:"RequestService::RequestList:CompletionDate",prop:"endDate",flexGrow:3},{name:"RequestService::RequestList:OnBehalfOf",prop:"employeeName",flexGrow:3,excludeTab:[_.MyRequests,_.OnBehalfForMe]},{name:"RequestService::RequestList:OnBehalfRequester",prop:"employeeName",flexGrow:3,excludeTab:[_.MyRequests,_.OnBehalfByMe]},{name:"::Actions",prop:"actions",maxWidth:50,flexGrow:1,cellClass:"action-cell"},{name:"RequestService::RequestList:ActionRate",prop:"actionRate",flexGrow:1.4,maxWidth:46,cellClass:"d-responsive-none"},{name:"RequestService::RequestList:ActionView",prop:"actionView",flexGrow:1.4,maxWidth:46,cellClass:"d-responsive-none"}],this.columns=this._columns}ngOnChanges({tab:t}){t.currentValue!==t.previousValue&&(this.columns=this._columns.filter(a=>!a.excludeTab?.find(i=>i===t.currentValue)))}ngOnInit(){this.sub$=this.service.list.hookToQuery(i=>(this.data.items=[],this.service.getList(i))).subscribe(i=>{this.data=i})}onPageSizeChange(t,a){a.limit=t,this.service.list.maxResultCount=t,this.service.list.page=0}onPageNumberChange(t){this.service.list.page=t-1}ngOnDestroy(){this.sub$?.unsubscribe()}redircetRequestUrl(t){if(t){const a=this._environmentService.getEnvironment().application.baseUrl;t.startsWith(a)?this._router.navigate([t.replace(a,"")]):window.location.href=t}}refresh(){this.service.refresh(!1)}showRatingModal(t,a){a.requestStatusCode!==C.Z.Cancelled&&a.requestStatusCode!==C.Z.Closed||t.openModal(a.id,a.serviceId)}withdrawRequest(t){this._swConfirmationService.warn("RequestService::WithdrawRequestConfirm","::AreYouSure",void 0,{yesSeverity:"error"}).pipe((0,m.filter)(a=>a===l.SWConfirmation.SWStatus.confirm),(0,m.switchMap)(()=>this.service.withdrawRequest(t))).subscribe(()=>{this._toasterService.success("::Success"),this.service.refresh()})}static#e=this.\u0275fac=function(a){return new(a||n)(e.\u0275\u0275directiveInject(R),e.\u0275\u0275directiveInject(x.Router),e.\u0275\u0275directiveInject(g.EnvironmentService),e.\u0275\u0275directiveInject(l.SWConfirmationService),e.\u0275\u0275directiveInject(S.ToasterService))};static#t=this.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["app-request-list"]],inputs:{tab:"tab"},features:[e.\u0275\u0275NgOnChangesFeature],decls:10,vars:8,consts:[[1,"card","mt-3","ngx-datatable-card"],[1,"card-body","p-3"],[1,"ngx-datatable-container"],["default","",3,"rows","count","list","columnMode","limit"],["table",""],[3,"name","prop","flexGrow","sortable","resizeable","draggable","maxWidth","cellClass",4,"ngFor","ngForOf"],["ngx-datatable-footer-template",""],[3,"requestEvaluated"],["requestEvaluation",""],[3,"name","prop","flexGrow","sortable","resizeable","draggable","maxWidth","cellClass"],["ngx-datatable-cell-template",""],[1,"column-label"],[3,"ngSwitch"],[3,"ngTemplateOutlet",4,"ngSwitchCase"],[3,"ngTemplateOutlet",4,"ngSwitchDefault"],["columStatus",""],["columnEmpty",""],["columnBold",""],["columnDate",""],["valueOnly",""],["columnView",""],["columnRate",""],["columnAction",""],[3,"ngTemplateOutlet"],[3,"requestStatus"],[3,"value"],[1,"btn","btn-outline-primary","action-btn","p-1",3,"disabled","click"],[1,"icon-document-text"],["class","icon-star",4,"ngIf"],["class","rating-img","src","./assets/images/request/star-fill.svg","alt","Rating",4,"ngIf"],[1,"icon-star"],["src","./assets/images/request/star-fill.svg","alt","Rating",1,"rating-img"],["ngbDropdown","","container","body",1,"action-dropdown-menu"],["data-toggle","dropdown","aria-haspopup","true","ngbDropdownToggle","",1,"btn","btn-primary","btn-sm","dropdown-toggle"],[1,"icon-dots-horizontal"],["ngbDropdownMenu","",1,"ngx-datatable-dropdown"],["ngbDropdownItem","",3,"click",4,"ngFor","ngForOf"],["ngbDropdownItem","",3,"click",4,"ngIf"],["ngbDropdownItem","",1,"d-xl-none",3,"disabled","click"],[1,"icon-document-text","text-primary"],["class","icon-star text-primary",4,"ngIf"],["ngbDropdownItem","",3,"click"],[1,"icon-star","text-primary"],["loaderImage","table.svg","nodataImage","tasks.svg","noFilterResultImage","no-filter-result.svg",3,"isLoadingData","isDataNotEmpty","isDataFiltered","nodataMessage","nodataHint","noFilterResultMessage","noFilterResultHint"],[1,"w-100","footer"],[3,"page","size","count","pageNumberChanged","pageSizeChanged"]],template:function(a,i){1&a&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2)(3,"ngx-datatable",3,4),e.\u0275\u0275template(5,me,3,10,"ngx-datatable-column",5),e.\u0275\u0275elementStart(6,"ngx-datatable-footer"),e.\u0275\u0275template(7,_e,7,18,"ng-template",6),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(8,"app-request-evaluation",7,8),e.\u0275\u0275listener("requestEvaluated",function(){return i.refresh()}),e.\u0275\u0275elementEnd()),2&a&&(e.\u0275\u0275advance(3),e.\u0275\u0275classProp("is-empty",i.service.isLoading||0===i.data.items.length),e.\u0275\u0275property("rows",i.data.items)("count",i.data.totalCount)("list",i.service.list)("columnMode","flex")("limit",i.service.list.maxResultCount),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",i.columns))},dependencies:[d.NgForOf,d.NgIf,d.NgTemplateOutlet,d.NgSwitch,d.NgSwitchCase,d.NgSwitchDefault,q.DatatableComponent,q.DataTableColumnDirective,q.DataTableColumnCellDirective,q.DataTableFooterTemplateDirective,q.DatatableFooterDirective,S.NgxDatatableDefaultDirective,S.NgxDatatableListDirective,p.PagerComponent,p.NodataOrLoadingComponent,p.EmptyComponent,p.RequestStatusBadgeComponent,f.NgbDropdown,f.NgbDropdownToggle,f.NgbDropdownMenu,f.NgbDropdownItem,z,d.DatePipe,g.LocalizationPipe],styles:[".rating-img[_ngcontent-%COMP%]{width:1.25rem;margin-top:-10px}app-nodata-or-loading[_ngcontent-%COMP%]{min-height:270px}.action-btn[_ngcontent-%COMP%]:disabled{opacity:.25}"]})}return n})();function ge(n,o){if(1&n&&(e.\u0275\u0275elementStart(0,"span",16),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("( ",t.count," )")}}function ve(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",14),e.\u0275\u0275listener("click",function(){const r=e.\u0275\u0275restoreView(t).$implicit,c=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(c.changeServiceCategory(null==r.category?null:r.category.id))}),e.\u0275\u0275element(1,"i"),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,ge,2,1,"span",15),e.\u0275\u0275elementEnd()}if(2&n){const t=o.$implicit,a=e.\u0275\u0275nextContext();let i;e.\u0275\u0275classProp("active",(null!==(i=a.selectedServiceCategoryId)&&void 0!==i?i:null)===(null==t.category?null:t.category.id)),e.\u0275\u0275advance(1),e.\u0275\u0275classMap(null==t.category?null:t.category.icon),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.category?t.category.displayName:e.\u0275\u0275pipeBind1(4,6,"RequestService::RequestFilter:All")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",void 0!==t.count)}}function fe(n,o){if(1&n&&(e.\u0275\u0275elementStart(0,"span",16),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("( ",t.count," )")}}function he(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",14),e.\u0275\u0275listener("click",function(){const r=e.\u0275\u0275restoreView(t).$implicit,c=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(c.changeSubCategory(null==r.category?null:r.category.id))}),e.\u0275\u0275elementStart(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,fe,2,1,"span",15),e.\u0275\u0275elementEnd()}if(2&n){const t=o.$implicit,a=e.\u0275\u0275nextContext(2);let i;e.\u0275\u0275classProp("active",(null!==(i=a.selectedSubCategoryId)&&void 0!==i?i:null)===(null==t.category?null:t.category.id)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.category?t.category.displayName:e.\u0275\u0275pipeBind1(3,4,"TaskService::Tasks:All")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",void 0!==t.count)}}function Ce(n,o){if(1&n&&(e.\u0275\u0275elementStart(0,"ng-scrollbar",17)(1,"div",18),e.\u0275\u0275template(2,he,5,6,"div",10),e.\u0275\u0275elementEnd()()),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("track","horizontal"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.subServiceCategory)}}let be=(()=>{class n{get tab(){return this._tab}get selectedServiceCategoryId(){return this._selectedServiceCategoryId}get selectedSubCategoryId(){return this._selectedSubCategoryId}constructor(t,a,i){this._requestService=t,this._appStatusService=a,this._activatedRoute=i,this.RequestTabEnum=_,this.serviceCategory=[],this.subServiceCategory=[],this._pageUi="app-request-filter"}ngOnInit(){this.serviceCategoryItems=this._activatedRoute.data.value.serviceCategory.items,this.serviceCategory=[{category:void 0,count:void 0},...this.serviceCategoryItems.map(r=>({category:r,count:void 0}))],this.subServiceCategory=[{category:void 0,count:void 0}],this._uiStatus=this._appStatusService.loadStatus(this._pageUi);const t=this._uiStatus.members.filters?.tab??_.MyRequests,a=this._uiStatus.members.filters?.requestForm?.serviceCategoryId,i=this._uiStatus.members.filters?.requestForm?.serviceSubCategoryId;this._requestService.init(t,a,i),this._getSubCategoryByCategoryId(a),this._requestService.changeServiceCategoryTab$.subscribe(r=>{this._selectedServiceCategoryId!==r&&(this._selectedServiceCategoryId=r,this._getSubCategoryByCategoryId(r))}),this._requestService.changeMainTab$.subscribe(r=>{this._tab=r}),this._requestService.changeSubCategoryTab$.subscribe(r=>{this._selectedSubCategoryId=r}),this._requestService.filterChanged$.subscribe(r=>{r&&this._getStatistics()})}changeTab(t){this._requestService.changeTab(t)}changeServiceCategory(t){this._requestService.changeServiceCategory(t)}changeSubCategory(t){this._selectedSubCategoryId=t,this._requestService.changeSubCategory(t)}_getStatistics(){this._getStatistics$?.unsubscribe(),this._getStatistics$=this._requestService.getRequestStatistics().subscribe(t=>{this.serviceCategory.forEach(a=>{a.count=t.find(i=>i.categoryId===a.category?.id)?.count??0}),this.serviceCategory.find(a=>null==a.category).count=t.reduce((a,i)=>a+i.count,0)})}_getSubCategoryByCategoryId(t){t?this._requestService.getService(t,{maxResultCount:1e3}).subscribe(a=>{this.subServiceCategory=[{category:void 0,count:void 0},...a.items.map(i=>({category:i,count:void 0}))]}):this.subServiceCategory=[{category:void 0,count:void 0}]}static#e=this.\u0275fac=function(a){return new(a||n)(e.\u0275\u0275directiveInject(R),e.\u0275\u0275directiveInject(l.AppStatusService),e.\u0275\u0275directiveInject(x.ActivatedRoute))};static#t=this.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["app-request"]],features:[e.\u0275\u0275ProvidersFeature([R,g.ListService,l.SelectedFiltersBannerService])],decls:29,vars:24,consts:[[3,"pageTitle","icon","oneLineResponsive"],[3,"serviceCategories"],[1,"tab-group"],[3,"track"],[1,"tab-container"],[1,"tab-item",3,"click"],[1,"icon-clipboard-copy"],[1,"icon-user-group"],[1,"icon-clock"],[1,"divider"],["class","tab-item sub-item",3,"active","click",4,"ngFor","ngForOf"],["class","scroll-sub-tabs",3,"track",4,"ngIf"],[1,"divider","my-3"],[3,"tab"],[1,"tab-item","sub-item",3,"click"],["class","ms-1",4,"ngIf"],[1,"ms-1"],[1,"scroll-sub-tabs",3,"track"],[1,"tab-container","sub-container"]],template:function(a,i){1&a&&(e.\u0275\u0275elementStart(0,"abp-page")(1,"app-page-header",0),e.\u0275\u0275element(2,"app-request-filter",1),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",2)(4,"ng-scrollbar",3)(5,"div",4)(6,"div",5),e.\u0275\u0275listener("click",function(){return i.changeTab(i.RequestTabEnum.MyRequests)}),e.\u0275\u0275element(7,"i",6),e.\u0275\u0275elementStart(8,"div"),e.\u0275\u0275text(9),e.\u0275\u0275pipe(10,"abpLocalization"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(11,"div",5),e.\u0275\u0275listener("click",function(){return i.changeTab(i.RequestTabEnum.OnBehalfByMe)}),e.\u0275\u0275element(12,"i",7),e.\u0275\u0275elementStart(13,"div"),e.\u0275\u0275text(14),e.\u0275\u0275pipe(15,"abpLocalization"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(16,"div",5),e.\u0275\u0275listener("click",function(){return i.changeTab(i.RequestTabEnum.OnBehalfForMe)}),e.\u0275\u0275element(17,"i",8),e.\u0275\u0275elementStart(18,"div"),e.\u0275\u0275text(19),e.\u0275\u0275pipe(20,"abpLocalization"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275element(21,"div",9),e.\u0275\u0275elementStart(22,"ng-scrollbar",3)(23,"div",4),e.\u0275\u0275template(24,ve,6,8,"div",10),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(25,Ce,3,2,"ng-scrollbar",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"app-selected-filters-banner"),e.\u0275\u0275element(27,"div",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(28,"app-request-list",13),e.\u0275\u0275elementEnd()),2&a&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("pageTitle","RequestService::Menu:Title")("icon","Group")("oneLineResponsive",!0),e.\u0275\u0275advance(1),e.\u0275\u0275property("serviceCategories",i.serviceCategoryItems),e.\u0275\u0275advance(2),e.\u0275\u0275property("track","horizontal"),e.\u0275\u0275advance(2),e.\u0275\u0275classProp("active",i.tab===i.RequestTabEnum.MyRequests),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(10,18,"RequestService::Tabs:MyRequests")),e.\u0275\u0275advance(2),e.\u0275\u0275classProp("active",i.tab===i.RequestTabEnum.OnBehalfByMe),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(15,20,"RequestService::Tabs:OnBehalfByMe")),e.\u0275\u0275advance(2),e.\u0275\u0275classProp("active",i.tab===i.RequestTabEnum.OnBehalfForMe),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(20,22,"RequestService::Tabs:OnBehalfForMe")),e.\u0275\u0275advance(3),e.\u0275\u0275property("track","horizontal"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",i.serviceCategory),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.subServiceCategory.length>1),e.\u0275\u0275advance(3),e.\u0275\u0275property("tab",i.tab))},dependencies:[d.NgForOf,d.NgIf,M.PageComponent,l.PageHeaderComponent,l.SelectedFiltersBannerComponent,F.NgScrollbar,L,de,g.LocalizationPipe],styles:["ng-scrollbar[_ngcontent-%COMP%]{height:66px}ng-scrollbar.scroll-sub-tabs[_ngcontent-%COMP%]{height:60px}[_nghost-%COMP%]  ng-scrollbar .scrollbar-control{visibility:hidden}[_nghost-%COMP%]  ng-scrollbar:hover .scrollbar-control{visibility:visible}.tab-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.tab-group[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{margin-bottom:25px}"]})}return n})();var Se=s(55355);const xe=[{path:"",component:be,resolve:{serviceCategory:()=>{const n=(0,e.inject)(Se.NgxSpinnerService),o=(0,e.inject)(h.s);return n.show(),o.getServiceCategoryLookup({maxResultCount:1e3}).pipe((0,m.finalize)(()=>n.hide()))}}}];let Re=(()=>{class n{static#e=this.\u0275fac=function(a){return new(a||n)};static#t=this.\u0275mod=e.\u0275\u0275defineNgModule({type:n});static#n=this.\u0275inj=e.\u0275\u0275defineInjector({imports:[x.RouterModule.forChild(xe),x.RouterModule]})}return n})();var qe=s(92134);let ye=(()=>{class n{static#e=this.\u0275fac=function(a){return new(a||n)};static#t=this.\u0275mod=e.\u0275\u0275defineNgModule({type:n});static#n=this.\u0275inj=e.\u0275\u0275defineInjector({imports:[Re,qe.b,f.NgbRatingModule]})}return n})()},92134:(I,y,s)=>{s.d(y,{b:()=>T});var e=s(81011),l=s(92482),m=s(78570),h=s(37385),d=s(82830),F=s(31093),p=s(62411),v=s(11705);let T=(()=>{class b{static#e=this.\u0275fac=function(w){return new(w||b)};static#t=this.\u0275mod=v.\u0275\u0275defineNgModule({type:b});static#n=this.\u0275inj=v.\u0275\u0275defineInjector({imports:[e.CoreModule,l.SharedModule,m.AbpUtilsModule,h.NgScrollbarModule,e.CoreModule,m.AbpUtilsModule,l.SharedModule,d.NgbTooltipModule,F.NgSelectModule,p.CommonModule,h.NgScrollbarModule,d.NgbDropdownModule,d.NgbDatepickerModule]})}return b})()}}]);