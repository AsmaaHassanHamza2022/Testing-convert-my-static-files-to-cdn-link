(self.webpackChunkportal=self.webpackChunkportal||[]).push([[41212],{41212:(T,C,o)=>{o.r(C),o.d(C,{DocumentLibraryModule:()=>U});var p=o(28675),f=o(81011),l=o(78570),M=o(66035),c=o(92482),e=o(11705),b=o(42595),u=o(21786),d=o(27437),x=o(82830),D=o(36503),h=o(4125),S=o(13087),_=o(36394),g=o(74478),E=o(31093);let y=(()=>{class t extends l.AbstractAdvancedFilterComponent{constructor(a,n,r){super(!0),this._targetAudienceService=a,this._router=n,this.activatedRoute=r,this.allTypes=[],this.searchSectorFn=this._searchSector.bind(this),this.searchDepartmentFn=this._searchDepartment.bind(this),this._routerSubscription=this._router.events.pipe((0,h.filter)(s=>s instanceof p.NavigationEnd||s instanceof p.NavigationSkipped)).subscribe(s=>{this._searchTitle=this._router.getCurrentNavigation().extras?.state?.searchTitle,this._searchTitle&&s instanceof p.NavigationSkipped&&this.chnageFilterText(this._searchTitle.slice(0,50))})}ngOnInit(){this._getTypeLookup(),super.ngOnInit(),this.buildControlValueChanges(),this._searchTitle&&this.chnageFilterText(this._searchTitle.slice(0,50)),this.activatedRoute.queryParams.subscribe(a=>{a.Title&&(this._searchTitle=a.Title,this.chnageFilterText(this._searchTitle?.slice(0,50)))})}initForm(){this.filtersForm=this.fb.group({documentCategory:new l.FilterFormControl({filterTitle:"CMSService::DocumentType",validatorOrOpts:[],filterValueFun:a=>this.allTypes.find(n=>n.id==a).displayName}),sectorId:new l.FilterFormControl({filterTitle:"CMSService::DocumentSector",validatorOrOpts:[],filterValueFun:null}),mainDepartmentId:new l.FilterFormControl({filterTitle:"CMSService::Documents:GeneralAdministration",validatorOrOpts:[],filterValueFun:null})})}buildControlValueChanges(){const a=this.filtersForm.controls.sectorId;a.valueChanges.pipe((0,h.startWith)(a.value),(0,h.pairwise)()).subscribe(([n,r])=>{n!=r&&this.filtersForm.controls.mainDepartmentId.setValue(void 0)})}_searchSector(a){return this._targetAudienceService.getCstSectorLookUpByInput(a)}_searchDepartment(a){const n=this.filtersForm.controls.sectorId.value;return n?this._targetAudienceService.getCstGeneralDepartmentsBySectorIdBySectorIdAndInput(n,a):(0,h.of)([])}_getTypeLookup(){const a=Object.values(D.b).filter(n=>!1===isNaN(Number(n))).map(n=>({id:n,displayName:this.localizationService.instant("CMSService::Enum:DocumentCategory:"+n)}));this.allTypes=a}ngOnDestroy(){super.ngOnDestroy(),this._routerSubscription?.unsubscribe()}static#e=this.\u0275fac=function(n){return new(n||t)(e.\u0275\u0275directiveInject(S.d),e.\u0275\u0275directiveInject(p.Router),e.\u0275\u0275directiveInject(p.ActivatedRoute))};static#t=this.\u0275cmp=e.\u0275\u0275defineComponent({type:t,selectors:[["app-document-library-filters"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:29,vars:27,consts:[[3,"filterText","isShowFilters","searchInputText","advancedSearchText","filterTextChange","showAdvancedFilter"],[1,"filters-form",3,"formGroup","ngSubmit"],[1,"scroll-bar"],[1,"row"],[1,"form-group","mt-3"],[1,"form-label"],["formControlName","sectorId",3,"searchFn","valueChanged"],[1,"form-group","mt-2"],["formControlName","mainDepartmentId",3,"searchFn","valueChanged"],["formControlName","documentCategory","bindLabel","displayName","bindValue","id",3,"items"],[1,"filter-actions"],["type","submit",1,"btn","btn-primary"],["type","button",1,"btn","btn-close-bar",3,"click"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"app-sw-filter",0),e.\u0275\u0275listener("filterTextChange",function(m){return r.chnageFilterText(m)})("showAdvancedFilter",function(m){return m?r.showFilterSidebar():r.closeFilterSidebar()}),e.\u0275\u0275pipe(1,"abpLocalization"),e.\u0275\u0275pipe(2,"abpLocalization"),e.\u0275\u0275elementStart(3,"form",1),e.\u0275\u0275listener("ngSubmit",function(){return r.submitFilterForm()}),e.\u0275\u0275elementStart(4,"div",2)(5,"div",3)(6,"div",4)(7,"label",5),e.\u0275\u0275text(8),e.\u0275\u0275pipe(9,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"app-ng-select-auto-complete",6),e.\u0275\u0275listener("valueChanged",function(m){return r.changeFilterValueForDropDown(m,"sectorId")}),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(11,"div",7)(12,"label",5),e.\u0275\u0275text(13),e.\u0275\u0275pipe(14,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"app-ng-select-auto-complete",8),e.\u0275\u0275listener("valueChanged",function(m){return r.changeFilterValueForDropDown(m,"mainDepartmentId")}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(16,"div",7)(17,"label",5),e.\u0275\u0275text(18),e.\u0275\u0275pipe(19,"abpLocalization"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(20,"ng-select",9),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(21,"div",10)(22,"button",11)(23,"span"),e.\u0275\u0275text(24),e.\u0275\u0275pipe(25,"abpLocalization"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(26,"button",12),e.\u0275\u0275listener("click",function(){return r.filtersForm.reset()}),e.\u0275\u0275text(27),e.\u0275\u0275pipe(28,"abpLocalization"),e.\u0275\u0275elementEnd()()()()),2&n&&(e.\u0275\u0275property("filterText",r.quickFilter.filterValue)("isShowFilters",r.isShowFilters)("searchInputText",e.\u0275\u0275pipeBind1(1,13,"CMSService::Documents:Search"))("advancedSearchText",e.\u0275\u0275pipeBind1(2,15,"CMSService::Documents:FilterDocuments")),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",r.filtersForm),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(9,17,"CMSService::DocumentSector")),e.\u0275\u0275advance(2),e.\u0275\u0275property("searchFn",r.searchSectorFn),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(14,19,"CMSService::Documents:GeneralAdministration")),e.\u0275\u0275advance(2),e.\u0275\u0275property("searchFn",r.searchDepartmentFn),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(19,21,"CMSService::DocumentType")),e.\u0275\u0275advance(2),e.\u0275\u0275property("items",r.allTypes),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(25,23,"::AdvancedFilter:Refresh")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(28,25,"::AdvancedFilter:Clear")," "))},dependencies:[_.\u0275NgNoValidate,_.NgControlStatus,_.NgControlStatusGroup,_.FormGroupDirective,_.FormControlName,f.FormSubmitDirective,g.ValidationGroupDirective,g.ValidationDirective,c.NgSelectAutoCompleteComponent,c.SwFilterComponent,E.NgSelectComponent,f.LocalizationPipe],encapsulation:2})}return t})();var v=o(62411);function I(t,i){if(1&t&&(e.\u0275\u0275elementStart(0,"div",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"span",16),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()),2&t){const a=i.column,n=i.rowIndex,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(a.name),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",r.list.page*r.list.maxResultCount+n+1,"")}}function L(t,i){if(1&t&&(e.\u0275\u0275elementStart(0,"div",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"span",16)(3,"span",17),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd()()),2&t){const a=i.column,n=i.row;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(a.name),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("ngbTooltip",n.fileName),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.fileName," ")}}function F(t,i){if(1&t&&(e.\u0275\u0275elementStart(0,"div",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"abpLocalization")),2&t){const a=i.column,n=i.row;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(a.name),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,2,"CMSService::Enum:DocumentCategory:"+n.documentCategory)," ")}}function P(t,i){if(1&t&&(e.\u0275\u0275elementStart(0,"div",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(2)),2&t){const a=i.column,n=i.row;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(a.name),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.sectorName," ")}}function N(t,i){if(1&t&&(e.\u0275\u0275elementStart(0,"div",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(2)),2&t){const a=i.column,n=i.row;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(a.name),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.mainDepartmentName," ")}}function O(t,i){if(1&t&&(e.\u0275\u0275elementStart(0,"div",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"date")),2&t){const a=i.column,n=i.row,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(a.name),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(3,2,n.publishDate,r.AppConsts.DateOnlyFormat)," ")}}function w(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",21),e.\u0275\u0275element(1,"i",22),e.\u0275\u0275pipe(2,"abpLocalization"),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("ngbTooltip",e.\u0275\u0275pipeBind1(2,1,"CMSService::Documents:Download")))}function A(t,i){if(1&t&&(e.\u0275\u0275elementStart(0,"div",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"div",18)(3,"app-base64-file-preview",19),e.\u0275\u0275pipe(4,"attachmentFile"),e.\u0275\u0275template(5,w,3,3,"ng-template",null,20,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()()),2&t){const a=i.column,n=i.row,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(a.name),e.\u0275\u0275advance(2),e.\u0275\u0275property("previewMode",r.PreviewModeEnum.Link)("base64File",e.\u0275\u0275pipeBind3(4,3,n.fileAttachmentId,r.entity,"cms-service/documents"))}}function B(t,i){if(1&t){const a=e.\u0275\u0275getCurrentView();e.\u0275\u0275element(0,"app-nodata-or-loading",23),e.\u0275\u0275pipe(1,"abpLocalization"),e.\u0275\u0275pipe(2,"abpLocalization"),e.\u0275\u0275pipe(3,"abpLocalization"),e.\u0275\u0275pipe(4,"abpLocalization"),e.\u0275\u0275elementStart(5,"div",24)(6,"app-pager",25),e.\u0275\u0275listener("pageNumberChanged",function(r){e.\u0275\u0275restoreView(a);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onPageNumberChange(r))})("pageSizeChanged",function(r){e.\u0275\u0275restoreView(a);const s=e.\u0275\u0275nextContext(),m=e.\u0275\u0275reference(8);return e.\u0275\u0275resetView(s.onPageSizeChange(r,m))}),e.\u0275\u0275elementEnd()()}if(2&t){const a=i.rowCount,n=i.pageSize,r=i.curPage,s=e.\u0275\u0275nextContext();e.\u0275\u0275property("isLoadingData",s.service.isLoading)("isDataNotEmpty",s.service.data.items.length>0)("isDataFiltered",s.service.isFiltering)("nodataMessage",e.\u0275\u0275pipeBind1(1,10,"CMSService::NoDocumentsCurrently"))("nodataHint",e.\u0275\u0275pipeBind1(2,12,"CMSService::ReturnLater"))("noFilterResultMessage",e.\u0275\u0275pipeBind1(3,14,"CMSService::DocumentsNoFilterResult"))("noFilterResultHint",e.\u0275\u0275pipeBind1(4,16,"CMSService::ChangeFilters")),e.\u0275\u0275advance(6),e.\u0275\u0275property("page",r)("size",n)("count",a)}}function R(t){return new l.ListFilterService(t.getListActive)}const z=[{path:"",component:(()=>{class t extends l.AbstractListComponent{constructor(a){super(),this.service=a,this.PreviewModeEnum=l.PreviewModeEnum,this.AppConsts=c.AppConsts}ngOnInit(){this.entity="ar"===this.localizationService.currentLang?"ArDocumentAttachment":"EnDocumentAttachment"}static#e=this.\u0275fac=function(n){return new(n||t)(e.\u0275\u0275directiveInject(l.ListFilterService))};static#t=this.\u0275cmp=e.\u0275\u0275defineComponent({type:t,selectors:[["app-document-library"]],features:[e.\u0275\u0275ProvidersFeature([f.ListService,l.SelectedFiltersBannerService,{provide:l.ListFilterService,useFactory:R,deps:[M.Z]}]),e.\u0275\u0275InheritDefinitionFeature],decls:31,vars:40,consts:[[3,"pageTitle","icon"],[1,"card","mt-3","ngx-datatable-card"],[1,"card-body","p-3"],[1,"ngx-datatable-container"],["default","",3,"rows","count","list","columnMode"],["table",""],["name","#",1,"hide",3,"flexGrow","sortable"],["ngx-datatable-cell-template",""],["prop","fileName",3,"name","flexGrow","sortable"],["prop","documentCategory",3,"name","flexGrow","sortable"],["prop","sectorName",3,"name","flexGrow","sortable"],["prop","mainDepartmentName",3,"name","flexGrow","sortable"],["prop","publishDate",3,"name","flexGrow","sortable"],[3,"flexGrow","sortable","name"],["ngx-datatable-footer-template","","ngx-datatable-footer-template",""],[1,"column-label"],[1,"text-bold"],["container","body",3,"ngbTooltip"],[1,"icons"],[3,"previewMode","base64File"],["customLinkTemplate",""],[1,"btn","btn-outline-primary","action-btn"],["container","body",1,"icon-download",3,"ngbTooltip"],["loaderImage","table.svg","nodataImage","books.svg","noFilterResultImage","no-filter-result.svg",3,"isLoadingData","isDataNotEmpty","isDataFiltered","nodataMessage","nodataHint","noFilterResultMessage","noFilterResultHint"],[1,"w-100","footer"],[3,"page","size","count","pageNumberChanged","pageSizeChanged"]],template:function(n,r){1&n&&(e.\u0275\u0275elementStart(0,"abp-page")(1,"app-page-header",0),e.\u0275\u0275element(2,"app-document-library-filters"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"app-selected-filters-banner"),e.\u0275\u0275elementStart(4,"div",1)(5,"div",2)(6,"div",3)(7,"ngx-datatable",4,5)(9,"ngx-datatable-column",6),e.\u0275\u0275template(10,I,4,2,"ng-template",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"ngx-datatable-column",8),e.\u0275\u0275pipe(12,"abpLocalization"),e.\u0275\u0275template(13,L,5,3,"ng-template",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"ngx-datatable-column",9),e.\u0275\u0275pipe(15,"abpLocalization"),e.\u0275\u0275template(16,F,4,4,"ng-template",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"ngx-datatable-column",10),e.\u0275\u0275pipe(18,"abpLocalization"),e.\u0275\u0275template(19,P,3,2,"ng-template",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"ngx-datatable-column",11),e.\u0275\u0275pipe(21,"abpLocalization"),e.\u0275\u0275template(22,N,3,2,"ng-template",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"ngx-datatable-column",12),e.\u0275\u0275pipe(24,"abpLocalization"),e.\u0275\u0275template(25,O,4,5,"ng-template",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"ngx-datatable-column",13),e.\u0275\u0275pipe(27,"abpLocalization"),e.\u0275\u0275template(28,A,7,7,"ng-template",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"ngx-datatable-footer"),e.\u0275\u0275template(30,B,7,18,"ng-template",14),e.\u0275\u0275elementEnd()()()()()()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("pageTitle","CMSService::DocumentLibrary")("icon","library-icon"),e.\u0275\u0275advance(6),e.\u0275\u0275classProp("is-empty",r.service.isLoading||0===r.service.data.items.length),e.\u0275\u0275property("rows",r.service.data.items)("count",r.service.data.totalCount)("list",r.list)("columnMode","flex"),e.\u0275\u0275advance(2),e.\u0275\u0275property("flexGrow",1)("sortable",!1),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("name",e.\u0275\u0275pipeBind1(12,28,"CMSService::DocumentFileName")),e.\u0275\u0275property("flexGrow",3)("sortable",!1),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("name",e.\u0275\u0275pipeBind1(15,30,"CMSService::DocumentType")),e.\u0275\u0275property("flexGrow",2)("sortable",!1),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("name",e.\u0275\u0275pipeBind1(18,32,"CMSService::DocumentSector")),e.\u0275\u0275property("flexGrow",2)("sortable",!1),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("name",e.\u0275\u0275pipeBind1(21,34,"CMSService::Documents:mainDepartment")),e.\u0275\u0275property("flexGrow",2)("sortable",!1),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("name",e.\u0275\u0275pipeBind1(24,36,"CMSService::DocumentCreationTime")),e.\u0275\u0275property("flexGrow",2)("sortable",!1),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("name",e.\u0275\u0275pipeBind1(27,38,"CMSService::Documents:Download")),e.\u0275\u0275property("flexGrow",1)("sortable",!1))},dependencies:[b.PageComponent,u.DatatableComponent,u.DataTableColumnDirective,u.DataTableColumnCellDirective,u.DataTableFooterTemplateDirective,u.DatatableFooterDirective,d.NgxDatatableDefaultDirective,d.NgxDatatableListDirective,l.PageHeaderComponent,l.Base64FilePerviewComponent,l.SelectedFiltersBannerComponent,c.PagerComponent,c.NodataOrLoadingComponent,x.NgbTooltip,y,v.DatePipe,f.LocalizationPipe,l.AttachmentPipe],styles:[".text-bold[_ngcontent-%COMP%]{font-weight:700}app-nodata-or-loading[_ngcontent-%COMP%]{min-height:270px}[_nghost-%COMP%]  .d-header-none .datatable-header-cell-template-wrap{display:none}"]})}return t})()}];let j=(()=>{class t{static#e=this.\u0275fac=function(n){return new(n||t)};static#t=this.\u0275mod=e.\u0275\u0275defineNgModule({type:t});static#n=this.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.RouterModule.forChild(z),p.RouterModule]})}return t})();var G=o(92134);let U=(()=>{class t{static#e=this.\u0275fac=function(n){return new(n||t)};static#t=this.\u0275mod=e.\u0275\u0275defineNgModule({type:t});static#n=this.\u0275inj=e.\u0275\u0275defineInjector({imports:[j,G.b]})}return t})()},92134:(T,C,o)=>{o.d(C,{b:()=>y});var p=o(81011),l=o(92482),c=o(78570),b=o(37385),d=o(82830),D=o(31093),S=o(62411),g=o(11705);let y=(()=>{class v{static#e=this.\u0275fac=function(F){return new(F||v)};static#t=this.\u0275mod=g.\u0275\u0275defineNgModule({type:v});static#n=this.\u0275inj=g.\u0275\u0275defineInjector({imports:[p.CoreModule,l.SharedModule,c.AbpUtilsModule,b.NgScrollbarModule,p.CoreModule,c.AbpUtilsModule,l.SharedModule,d.NgbTooltipModule,D.NgSelectModule,S.CommonModule,b.NgScrollbarModule,d.NgbDropdownModule,d.NgbDatepickerModule]})}return v})()}}]);